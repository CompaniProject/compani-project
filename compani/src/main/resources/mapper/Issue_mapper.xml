<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.compani.issue.mapper.IssueMapper">

	<select id="findIssue"
		resultType="com.yedam.compani.issue.service.IssueVO">
		SELECT I.ISSU_NO
		, I.PRJT_NO
		, I.BUSS_NO
		, I.MEMB_ID
		, I.ISSU_TTL
		, I.ISSU_CNTN
		, I.ISSU_KND
		, I.ISSU_RANK
		, I.ISSU_ST
		, I.ISSU_DT
		, P.PRJT_NM
		, B.BUSS_NM
		FROM ISSUE I, PROJECT P, BUSINESS B
		WHERE I.BUSS_NO = B.BUSS_NO
		AND B.PRJT_NO = P.PRJT_NO
		<choose>
			<when test="keyword == '작성자'">
				AND MEMB_ID LIKE '%' || #{search} || '%'
			</when>
			<when test="keyword == '제목'">
				AND ISSU_TTL LIKE '%' || #{search} || '%'
			</when>
			<when test="keyword == '전체'">
				AND (MEMB_ID LIKE '%' || #{search} || '%'
				OR ISSU_TTL LIKE '%' || #{search} || '%')
			</when>
		</choose>
		ORDER BY ISSU_DT ASC
	</select>

	<select id="getIssueList" resultType="IssueVO">
		SELECT p.PRJT_NM, 
			   i.MEMB_ID ,
			   i.ISSU_DT,
			   i.ISSU_ST
		FROM   project p , issue i
		WHERE  p.prjt_NO = i.prjt_NO

	</select>

</mapper>