<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.compani.file.mapper.FileMapper">
	
				<!-- 파일 리스트 (업무 파일함)-->
				<select id="fileList" resultType="FileVO">
					SELECT	  FILE_NO
						    , FILE_NM
						    , FILE_SIZE
						    , MEMB_ID
						   	, FILE_DT
					FROM   	 PROJECT_FILE
					ORDER BY FILE_NO DESC
				</select>
				
				
				<!-- 파일 리스트 (프로젝트 자료함) -->
				<select id="fileInfo" resultType="FileVO">
				
				</select>
				
				
				<!-- 파일 업로드 (업무 파일함) -->
				<insert id="fileInsert" parameterType="FileVO">
					<selectKey keyProperty="fileNo"
							   resultType="int"
							   order="BEFORE">
					SELECT MAX(FILE_NO)
					FROM   PROJECT_FILE
					</selectKey>
					
				</insert>
				
				
				<!-- 파일 삭제 (업무 파일함, 프로젝트 자료함)-->
				<delete id="fileDelete" parameterType="FileVO">
					DELETE FROM PROJECT_FILE
					WHERE 		FILE_NO = #{fileNo}
				</delete>
		
				<!-- 업무 모달 파일 검색기능 -->
				<select id="fileSearch" resultType="FileVO">
					SELECT F.FILE_NO
						   , P.PRJT_NM
						   , B.BUSS_NM
						   , F.FILE_NM
						   , F.FILE_PATH
						   , F.FILE_TYPE
						   , F.FILE_DESCT
						   , F.FILE_DT
						   , F.MEMB_ID
						   , F.FILE_SIZE
					FROM  PROJECT_FILE F, BUSINESS B, PROJECT P
					WHERE F.BUSS_NO = B.BUSS_NO
					AND   B.PRJT_NO = P.PRJT_NO
					<choose>
						<when test="keyword == 'fName'">
						AND F.FILE_NM LIKE '%' || {#fileNm} || '%' 
						</when>
						<when test="keyword == 'fWriter">
						AND F.MEMB_ID LIKE '%' || {#membId} || '%'
						</when>
					</choose>
					ORDER BY FILE_NO DESC
				</select>
		
</mapper>