<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layout/layout}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<style>
.editBtn {
	cursor: pointer;
}

.delBtn {
	cursor: pointer;
	margin-right: 3%;
}

.submitBtn {
	margin-right: 3%;
	cursor: pointer;
	display: none;
	color: blue;
}
</style>

</head>

<body>
	<th:block layout:fragment="content">
		<div class="row">
			<div class="col-lg-8">
				<div class="column">
					<div>
						<div class="row">

							<div class="col-lg-3">
								<div class="card">
									<div class="stat-widget-one">
										<div class="stat-content">
											<div class="stat-digit gradient-3-text" id="bussCnt"
												style="font-size: 50px"></div>
											<div class="stat-text" style="padding-top: 30px;font-size: 17px">총 업무
												수</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-lg-3">
								<div class="card">
									<div class="stat-widget-one" style="padding-bottom: 5px">
										<div class="stat-content">
											<div class="stat-digit gradient-3-text"
												style="padding-bottom: 10px; font-size: 25px">
												완료한 업무</div>
											<div class="stat-text"
												style="padding-top: 20px; padding-bottom: 0px;"
												id="bussComp">1</div>
										</div>
										<div class="progress mb-3"
											style="margin: 10px; margin-bottom: 0;">
											<div class="progress-bar gradient-3"
												style="width: 50%; margin-bottom: 0;" id="bussCompBar"
												role="progressbar"></div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-lg-3">
								<div class="card">
									<div class="stat-widget-one" style="padding-bottom: 5px">
										<div class="stat-content">
											<div class="stat-digit gradient-3-text"
												style="padding-bottom: 10px; font-size: 25px">
												초과된 업무</div>
											<div class="stat-text"
												style="padding-top: 20px; padding-bottom: 0px;"
												id="bussFair">1</div>
										</div>
										<div class="progress mb-3"
											style="margin: 10px; margin-bottom: 0;">
											<div class="progress-bar gradient-3"
												style="width: 50%; margin-bottom: 0;" id="bussFairBar"
												role="progressbar"></div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-lg-3">
								<div class="card">
									<div class="stat-widget-one" style="padding-bottom: 5px">
										<div class="stat-content">
											<div class="stat-digit gradient-3-text"
												style="padding-bottom: 10px; font-size: 25px">
												미완료 업무</div>
											<div class="stat-text"
												style="padding-top: 20px; padding-bottom: 0px;"
												id="bussFair">1</div>
										</div>
										<div class="progress mb-3"
											style="margin: 10px; margin-bottom: 0;">
											<div class="progress-bar gradient-3"
												style="width: 50%; margin-bottom: 0;" id="bussFairBar"
												role="progressbar"></div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-lg-6" style="padding-right: 0px">
								<div class="card">
									<div class="card-body">
										<div id="horizontal-bar-chart"
											class="ct-chart ct-golden-section">
											<canvas id="bussBarChart" width="300" height="250"></canvas>
											</div>
									</div>
								</div>
							</div>
							<div class="col-lg-6" style="padding-left: 0px">
								<div class="card">
									<div class="card-body"
										th:switch="${session.loginInfo.membWkgd}">
										<th:block th:case="''">
											<h4 class="card-title">[[${session.loginInfo.membNm}]]</h4>
										</th:block>
										<th:block th:case=null>
											<h4 class="card-title">[[${session.loginInfo.membNm}]]</h4>
										</th:block>
										<th:block th:case="*">
											<h4 class="card-title">[[${session.loginInfo.membWkgd}]]
												[[${session.loginInfo.membNm}]]</h4>
										</th:block>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Comemnt Area -->
			<div class="col-lg-4">
				<div class="card" style="height: 80vh;">
					<div class="card-header bg-white">
						<h5 class="card-title">Card title</h5>
						<h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6>
					</div>
					<div class="card-body"
						style="overflow-y: auto; background-color: #FAFAFA;"
						id="commentBody">
						<div class="card">
							<div class="card-body">
								<div class="media">
									<div class="media-body"></div>
								</div>
							</div>
						</div>
					</div>
					<!-- 댓글 등록 영역 -->
					<div class="card-footer">
						<textarea class="form-control" name="inputCntn" id="inputCntn"
							cols="30" rows="2" placeholder="Post a new message"
							style="height: 56px;"></textarea>
						<button id="insertBtn" class="btn btn-primary px-3 ml-4">Send</button>
					</div>
					<!-- 댓글 등록 영역 End -->
				</div>
			</div>
			<!-- Comment Area End -->
		</div>

		<div id="replyArea" style="display: none;">
			<div class="media mt-3">
				<textarea class="form-control" name="inputCntn" id="inputCntn"
					cols="30" rows="2" placeholder="Post a new message"
					style="height: 56px;"></textarea>
				<button id="insertBtn" class="btn btn-primary px-3 ml-4">Send</button>
			</div>
		</div>
		<script th:inline="javascript">
	let prjtml = [];
		
		
 	$(function(){
 		$.ajax('http://localhost/BussCnt', {
 		 	type : 'post',
 		 	dataType : 'json', 
 		 	data : {prjtNo : 1},
 		 	async: false
 			})
 			.done(result => {
 				$('#bussCnt').text(result);
 			})
 			.fail(err =>console.log("err")
 		);
 		
 		$.ajax('http://localhost/BussStCnt', {
 		 	type : 'post',
 		 	contentType: 'application/json',
 		 	dataType : 'json', 
 		 	data : JSON.stringify([{
 			 		prjtNo : 1,
 					bussSt : "0K2"
 		 			},
 		 			{
 			 		prjtNo : 1,
 					bussSt : "0K4"
 		 			}]),
 		 	async: false
 			})
 			.done(result => {
 				$('#bussCompBar').css('width', ((parseInt($('#bussComp').text())*100)/parseInt($('#bussCnt').text()))+'%');
 				$('#bussFairBar').css('width', ((parseInt($('#bussFair').text())*100)/parseInt($('#bussCnt').text()))+'%');
 				$('#bussComp').text(result["0K2"] +" / "+ $('#bussCnt').text());
				$('#bussFair').text(result["0K4"] +" / "+ $('#bussCnt').text());
 			})
 			.fail(err =>console.log("err")
 		);


 		
 		$.ajax("http://localhost/pfml", {
 		 	type : 'post',
 		 	contentType: 'application/json',
 		 	dataType : 'json', 
 		 	data : {prjtNo : 1},
 		 	async: false
 			})
 			.done(result => {
 				$.each(result, function(i, item){
 					console.log(item[i]);
 				});
 			})
 			.fail(err =>console.log("err")
 		);

 		
 		
 		
 		  new Chartist.Bar('#horizontal-bar-chart', {
 			    labels: prjtml,
 			    series: [
 			      [5, 4, 3, 7, 5, 10, 3],
 			      [3, 2, 9, 5, 4, 6, 4]
 			    ]
 			  }, {
 			    seriesBarDistance: 10,
 			    reverseData: true,
 			    horizontalBars: true,
 			    axisY: {
 			      offset: 70
 			    },
 			    plugins: [
 			      Chartist.plugins.tooltip()
 			    ]
 			  });
 	});

	</script>
		<script src="plugins/common/common.min.js"></script>
		<script src="js/custom.min.js"></script>
		<script src="js/settings.js"></script>
		<script src="js/gleek.js"></script>
		<script src="js/styleSwitcher.js"></script>

	</th:block>
</body>
</html>