<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layout/layout}">
<th:block layout:fragment="content">
	<div class="content-body">
		<button type="button" class="btn btn-primary" data-toggle="modal"
			data-target="#workModal">Launch workModal</button>

		<div class="modal fade" id="workModal" tabindex="-1"
			aria-labelledby="sidebarModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content"
					style="box-shadow: 0 3px 15px 0 rgba(0, 0, 0, 0.15); width: 780px; top: calc(( 86vh - 601px)/2); height: 671px; opacity: 1; z-index: 500; overflow:auto;">
					<!-- 모달 헤더 부분 -->
					<div class="modal-header">
						<div class="ContentTitleBox">
							<div class="ContentImg"
								style="background-image: url(/images/tab_issue.png);"></div>
							<p class="ContentText">이슈</p>
						</div>
						<button type="button" class="btn-close" data-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-content-container">
						<div class="workModalTab">
							<ul>
								<li><i class="ModalTab tab_basic"></i> <span
									class="tooltip">기본정보</span></li>
								<li><i class="ModalTab tab_file"></i> <span
									class=" tooltip">자료관리</span></li>
								<li><i class="ModalTab tab_issue"></i> <span
									class="tooltip">이슈</span></li>
								<li><i class="ModalTab tab_log"></i> <span class="tooltip">로그</span></li>
							</ul>
						</div>
						<div class="modal-body">
							<div class="workModalContentBack">
								<div class="workModalContentSlider">
									<div class="workModalContent issueContent">
										<div class="workModalBussTitle">
											<div class="ModalTitle">
												<div class="ModalProjectNameBox">
													<div id="ProjectLink">
														#<span></span>
														<p class="textEllipsis" th:text="${issueList[0].prjtNm}" />
													</div>
												</div>
												<div class="ModalBussNameBox Edit">
													<div class="ModalBussNameBack">
														<textarea id="ModalUpdateBussName"
															th:text="${issueList[0].bussNm}" readonly maxlength="200"
															style="height: 34px;"></textarea>
													</div>
												</div>
											</div>
										</div>
										<div class="ModalInfo">
											<div class="FixOnTop ModalTopBar">
												<div class="IssueTopBar">
													<div></div>
													<div class="TobBarIssueControlArea">

														<div class="SearchBox">
															<label for="SearchToggleCheckBox"
																th:attr="onclick='issuePaging(1)'"></label> <input
																type="hidden" id="keyword" name="keyword" value="전체">
															<div class="SearchInputBox" style="width: 270px;">
																<div>
																	<div class="issue-selectBox" style="width: 100px;">
																		<div class="issue-selected" id="issue-selected">
																			<div class="issue-selected-value">전체</div>
																			<div class="arrow"></div>
																		</div>
																		<ul class="issue-select-ul"
																			style="width: 100px; top: 20%; display: none;">
																			<li class="issue-select-option" data-value="전체">전체</li>
																			<li class="issue-select-option" data-value="작성자">작성자</li>
																			<li class="issue-select-option" data-value="제목">제목</li>
																		</ul>
																	</div>
																</div>
																<input class="SearchInputModalView" id="search"
																	name="search" type="text" placeholder="검색어를 입력하세요."><span
																	class="DeleteSearchWord"></span>
															</div>
														</div>

														<button class="PostWritingBox">
															<span></span>
															<p>글쓰기</p>
														</button>

													</div>
												</div>
											</div>
											<div class="ModalInfoArea IssueInfoArea">

												<div class="col-lg-6" style="width: 100%; max-width: 100%;">

													<div class="table-responsive">
														<table class="table table-hover">
															<thead>
																<tr>
																	<th style="font-weight: normal;">종류</th>
																	<th style="font-weight: normal;">제목</th>
																	<th style="font-weight: normal;">이름</th>
																	<th style="font-weight: normal;">상태</th>
																	<th style="font-weight: normal;">우선순위</th>
																</tr>
															</thead>
															<tbody id="issueLists">
																<th:block th:each="issueList : ${issueList}">
																	<tr>
																		<th th:if="${issueList.issuKnd == 'BUG'}"><span
																			class="badge badge-danger" th:text="버그"></span></th>
																		<th th:if="${issueList.issuKnd == 'IMPR'}"><span
																			class="badge badge-warning" th:text="개선사항"></span></th>
																		<th th:if="${issueList.issuKnd == 'FUNC'}"><span
																			class="badge badge-info" th:text="새기능"></span></th>
																		<th th:if="${issueList.issuKnd == 'BUSS'}"><span
																			class="badge badge-light" th:text="업무"></span></th>
																		<td th:text="${issueList.issuCntn}"></td>
																		<td th:text="${issueList.membId}"></td>
																		<th th:if="${issueList.issuSt == 'solve'}"><span
																			class="badge badge-pill badge-success" th:text="해결"></span></th>
																		<th th:if="${issueList.issuSt == 'unsolve'}"><span
																			class="badge badge-pill badge-dark" th:text="미해결"></span></th>
																		<th th:if="${issueList.issuSt == 'unsolvable'}"><span
																			class="badge badge-pill badge-secondary"
																			th:text="해결불가"></span></th>

																		<th th:if="${issueList.issuRank == '매우 높음'}"><span
																			class="badge badge-primary" th:text="매우높음"></span></th>
																		<th th:if="${issueList.issuRank == '높음'}"><span
																			class="badge badge-secondary" th:text="높음"></span></th>
																		<th th:if="${issueList.issuRank == '보통'}"><span
																			class="badge badge-success" th:text="보통"></span></th>
																		<th th:if="${issueList.issuRank == '낮음'}"><span
																			class="badge badge-warning" th:text="낮음"></span></th>
																		<th th:if="${issueList.issuRank == '매우 낮음'}"><span
																			class="badge badge-danger" th:text="매우낮음"></span></th>
																	</tr>
																</th:block>
															</tbody>
														</table>
													</div>
												</div>
											</div>
											<div
												class="paginate-container d-none d-sm-flex flex-sm-justify-center">
												<div role="navigation" aria-label="Pagination"
													class="pagination">

													<a id="previous_page"
														th:classappend="${issue.prePage == 0} ? 'disabled'"
														th:attr="onclick='issuePaging(\'' + ${issue.prePage} + '\')'">Previous</a>
													<a class="cur_page"
														th:each="page: ${#numbers.sequence(issue.navigateFirstPage, issue.navigateLastPage)}"
														th:text="${page}"
														th:attr="onclick='issuePaging(\'' + ${page} + '\')'"></a>
													<a id="next_page"
														th:classappend="${issue.nextPage == 0} ? 'disabled'"
														th:attr="onclick='issuePaging(\'' + ${issue.nextPage} + '\')'">Next</a>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<!-- @@@@@@@@@@@@@@@@@@@@@@@@여기서 부터 이슈 등록 폼@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->
							<div class="modalIssueInsertForm" style="display: none">
								<div class="modalInsertContent">
									<div class="issueInsertContentTopBar">
										<span class="cancelWriting"></span>
										<div class="completeWriting">등록</div>

									</div>
									<div class="writingContent">
										<div class="writingSection">
											<div class="sectionTitle">
												<p class="sectionTitleText">내용</p>
											</div>

											<div id="editor" style="width: 608px;"></div>

										</div>

										<div class="attachSection">
											<div class="sectionTitle">
												<p class="sectionTitleText">파일</p>
												<div class="LoadBtn upload">
													<span></span>
													<p>파일 업로드</p>
													<input type="file" class="real-upload" multiple style="display: none;">
												</div>
											</div>
											<form class="dropzone dz-clickable"
												action="https://mediumra.re/dropzone/upload.php">

												<span class="dz-message">Drop files here or click
													here to upload</span>
											</form>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script
		src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>
	<script>
		$('.PostWritingBox').on('click', function() {
			var workModalContentBack = $('.workModalContentBack');
			var modalIssueInsertForm = $('.modalIssueInsertForm');
			workModalContentBack.empty();
			workModalContentBack.append(modalIssueInsertForm);
			modalIssueInsertForm.css('display', 'block');
		});

		// 뒤로 가기 버튼 눌렀을 때 ..

		// toastuieditor
		const editor = new toastui.Editor({
			el : document.querySelector('#editor'), // 에디터를 적용할 요소 (컨테이너)
			height : '400px', // 에디터 영역의 높이 값 (OOOpx || auto)
			initialEditType : 'wysiwyg', // 최초로 보여줄 에디터 타입 (markdown || wysiwyg)
			initialValue : '내용을 입력해 주세요.', // 내용의 초기 값으로, 반드시 마크다운 문자열 형태여야 함
			previewStyle : 'vertical' // 마크다운 프리뷰 스타일 (tab || vertical)
		});
		
		// 파일 업로드 클릭
		const realUpload = document.querySelector('.real-upload');
    	const upload = document.querySelector('.LoadBtn.upload');

    	upload.addEventListener('click', () => realUpload.click());
	</script>
</th:block>
</html>